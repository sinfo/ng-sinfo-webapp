<!-- <app-menu [user]="user"></app-menu> -->
<mat-toolbar class="topbar">
  <button
    mat-icon-button
    style="color: white; background-color: black"
    class="menu-icon"
    aria-label="Menu icon"
    (click)="sidenav.toggle()"
  >
    <mat-icon
      *ngIf="!isCvUpdated && user && user.role !== 'company'"
      matBadge="!"
      matBadgeColor="warn"
      matBadgeSize="small"
    >
      menu</mat-icon
    >
    <mat-icon *ngIf="!user"> menu</mat-icon>
    <mat-icon *ngIf="isCvUpdated || (user && user.role === 'company')" style="transform: scale(1.5)">menu</mat-icon>
  </button>

  <a routerLink="/user" class="logo-sinfo">
    <img id="logo_white" src="assets/img/logo-branco2.png" alt="Sinfo" />
  </a>

  <a routerLink="/user/promocodes" class="promo-code logo_w">
    <mat-icon>receipt</mat-icon>
  </a>

  <a (click)="reloadApp()" class="refresh-button">
    <mat-icon>refresh</mat-icon>
  </a>
</mat-toolbar>

<mat-sidenav-container class="sidenav-container">
  <mat-sidenav #sidenav mode="over" [(opened)]="opened" class="sidenav">
    <mat-nav-list class="navlist">
      <a mat-list-item href="/" target="_blank" (click)="sidenav.toggle()">
        <div class="navigation-link">
          <mat-icon>computer</mat-icon>
          <span class="list-item">Go to website</span>
        </div>
      </a>
      <a *ngIf="isLoggedIn" mat-list-item routerLink="/user/qrcode" routerLinkActive="navigation-link active"
        (click)="sidenav.toggle()">
        <div class="navigation-link">
          <mat-icon>qr_code</mat-icon>
          <span class="list-item">QR Code</span>
        </div>
      </a>
      <a *ngIf="user && user.role !== 'company'" mat-list-item routerLink="/user/cv"
        routerLinkActive="navigation-link active" (click)="sidenav.toggle()" class="mat-list-item-custom">
        <div class="navigation-link">
          <mat-icon *ngIf="!isCvUpdated" matBadge="!" matBadgeColor="warn" matBadgeSize="small">account_box</mat-icon>
          <mat-icon *ngIf="isCvUpdated">account_box</mat-icon>
          <span class="list-item">Upload CV</span>
        </div>
      </a>
      <a *ngIf="user && user.role === 'team'" mat-list-item routerLink="/user/checkin"
        routerLinkActive="navigation-link active" (click)="sidenav.toggle()" class="mat-list-item-custom">
        <div class="navigation-link">
          <mat-icon>done_outline</mat-icon>
          <span class="list-item">Check-in</span>
        </div>
      </a>
      <a *ngIf="user && user.role === 'team'" mat-list-item routerLink="/user/validate-card"
        routerLinkActive="navigation-link active" (click)="sidenav.toggle()" class="mat-list-item-custom">
        <div class="navigation-link">
          <mat-icon>search</mat-icon>
          <span class="list-item">Validate Card</span>
        </div>
      </a>
      <a *ngIf="user && user.role === 'team'" mat-list-item routerLink="/user/promote"
        routerLinkActive="navigation-link active" (click)="sidenav.toggle()" class="mat-list-item-custom">
        <div class="navigation-link">
          <mat-icon>verified_user</mat-icon>
          <span class="list-item">Promote</span>
        </div>
      </a>
      <a *ngIf="user && user.role === 'company'" mat-list-item routerLink="/user/links/link"
        routerLinkActive="navigation-link active" (click)="sidenav.toggle()">
        <div class="navigation-link">
          <mat-icon>done_outline</mat-icon>
          <span class="list-item">Sign and Link Card</span>
        </div>
      </a>
      <a *ngIf="user && user.role === 'company'" mat-list-item routerLink="/user/links/my-links"
        routerLinkActive="navigation-link active" (click)="sidenav.toggle()">
        <div class="navigation-link">
          <mat-icon> forum</mat-icon>
          <span class="list-item">My links</span>
        </div>
      </a>

      <a *ngIf="user && user.role === 'user'" mat-list-item routerLink="/user/workshops"
        routerLinkActive="navigation-link active" [routerLinkActiveOptions]="{ exact: true }"
        (click)="sidenav.toggle()">
        <div class="navigation-link">
          <mat-icon> business</mat-icon>
          <span class="list-item">Workshops</span>
        </div>
      </a>

      <mat-accordion *ngIf="user && user.role === 'team'">
        <mat-expansion-panel style="background-color: transparent !important">
          <mat-expansion-panel-header class="specific-class">
            <a mat-list-item class="navigation-link">
              <div class="navigation-link">
                <mat-icon> business</mat-icon>
                <span class="list-item">Workshops</span>
                <mat-icon>keyboard_arrow_right</mat-icon>
              </div>
            </a>
          </mat-expansion-panel-header>
          <mat-nav-list>
            <a *ngIf="user && user.role !== 'company'" mat-list-item routerLink="/user/workshops"
              routerLinkActive="navigation-link active" [routerLinkActiveOptions]="{ exact: true }"
              (click)="sidenav.toggle()" class="navigation-link">
              <div class="navigation-link">
                <mat-icon> business</mat-icon>
                <span class="list-item">Workshops</span>
              </div>
            </a>
            <a *ngIf="user && user.role === 'team'" mat-list-item routerLink="/user/workshops/workshops-status"
              routerLinkActive="navigation-link active" (click)="sidenav.toggle()">
              <div class="navigation-link">
                <mat-icon>info</mat-icon>
                <span class="list-item">Workshop Status</span>
              </div>
            </a>
            <a *ngIf="user && user.role === 'team'" mat-list-item routerLink="/user/validate-workshop"
              routerLinkActive="navigation-link active" (click)="sidenav.toggle()">
              <div class="navigation-link">
                <mat-icon>event</mat-icon>
                <span class="list-item">Validate Workshop</span>
              </div>
            </a>
          </mat-nav-list>
        </mat-expansion-panel>

        <mat-expansion-panel style="background-color: transparent !important">
          <mat-expansion-panel-header class="specific-class">
            <a mat-list-item>
              <div class="navigation-link">
                <mat-icon>cake</mat-icon>
                <span class="list-item">Pick Winner</span>
                <mat-icon>keyboard_arrow_right</mat-icon>
              </div>
            </a>
          </mat-expansion-panel-header>
          <mat-nav-list>
            <a *ngIf="user && user.role === 'team'" mat-list-item routerLink="/user/prizes"
              routerLinkActive="navigation-link active" (click)="sidenav.toggle()">
              <div class="navigation-link">
                <mat-icon>cake</mat-icon>
                <span class="list-item">Prizes</span>
              </div>
            </a>
            <a *ngIf="user && user.role === 'team'" mat-list-item routerLink="/user/pick-winner"
              routerLinkActive="navigation-link active" (click)="sidenav.toggle()">
              <div class="navigation-link">
                <mat-icon>cake</mat-icon>
                <span class="list-item">Pick Winner</span>
              </div>
            </a>
          </mat-nav-list>
        </mat-expansion-panel>

        <mat-expansion-panel style="background-color: transparent !important">
          <mat-expansion-panel-header class="specific-class">
            <a mat-list-item class="navigation-link">
              <div class="navigation-link">
                <mat-icon>get_app</mat-icon>
                <span class="list-item">CV Downloads </span>
                <mat-icon>keyboard_arrow_right</mat-icon>
              </div>
            </a>
          </mat-expansion-panel-header>
          <mat-nav-list>
            <a *ngIf="user && user.role !== 'user'" mat-list-item routerLink="/user/downloads/download"
              routerLinkActive="navigation-link active" (click)="sidenav.toggle()">
              <div class="navigation-link">
                <mat-icon>get_app</mat-icon>
                <span class="list-item">Download CVs</span>
              </div>
            </a>
            <a *ngIf="user && user.role === 'team'" mat-list-item routerLink="/user/downloads/manage"
              routerLinkActive="navigation-link active" (click)="sidenav.toggle()">
              <div class="navigation-link">
                <mat-icon>get_app</mat-icon>
                <span class="list-item">Create Endpoints</span>
              </div>
            </a>
            <a *ngIf="user && user.role === 'team'" mat-list-item routerLink="/user/downloads/status"
              routerLinkActive="navigation-link active" (click)="sidenav.toggle()">
              <div class="navigation-link">
                <mat-icon>get_app</mat-icon>
                <span class="list-item">Endpoints Status</span>
              </div>
            </a>
          </mat-nav-list>
        </mat-expansion-panel>
      </mat-accordion>

      <a *ngIf="user && user.role === 'company'" mat-list-item routerLink="/user/downloads/download"
        routerLinkActive="navigation-link active" (click)="sidenav.toggle()">
        <div class="navigation-link">
          <mat-icon>get_app</mat-icon>
          <span class="list-item">Download CVs</span>
        </div>
      </a>

      <a *ngIf="user && user.role !== 'company'" mat-list-item routerLink="/user/achievements"
        routerLinkActive="navigation-link active" (click)="sidenav.toggle()">
        <div class="navigation-link">
          <mat-icon>grade</mat-icon>
          <span class="list-item">Achievements</span>
        </div>
      </a>
      <a *ngIf="user && user.role !== 'company'" mat-list-item routerLink="/user/my-card"
        routerLinkActive="navigation-link active" (click)="sidenav.toggle()">
        <div class="navigation-link">
          <mat-icon>school</mat-icon>
          <span class="list-item">My card</span>
        </div>
      </a>
      <!-- <a *ngIf="user && user.role === 'team'" mat-list-item routerLink="/user/secret-codes" routerLinkActive="navigation-link active"
        (click)="sidenav.toggle()">
        <mat-icon>stars</mat-icon>
        <span class="list-item">Secret Codes</span>
      </a> -->
      <a *ngIf="user && user.role !== 'company'" mat-list-item routerLink="/user/redeem"
        routerLinkActive="navigation-link active" (click)="sidenav.toggle()">
        <div class="navigation-link">
          <mat-icon>stars</mat-icon>
          <span class="list-item">Redeem Achievement</span>
        </div>
      </a>
      <a *ngIf="user" mat-list-item routerLink="/user/promocodes" routerLinkActive="navigation-link active"
        (click)="sidenav.toggle()" class="navigation-link">
        <div class="navigation-link">
          <mat-icon>receipt</mat-icon>
          <span class="list-item">Promo Codes</span>
        </div>
      </a>
      <div class="gap"></div>
      <div class="bottom">
        <a *ngIf="isLoggedIn" mat-list-item (click)="sidenav.toggle()" routerLink="/user/privacy-policy"
          routerLinkActive="navigation-link active">
          <div class="navigation-link">
            <mat-icon>info</mat-icon>
            <span class="list-item">Privacy Policy</span>
          </div>
        </a>
        <a *ngIf="isLoggedIn" mat-list-item (click)="sidenav.toggle()" routerLink="/user/coc"
          routerLinkActive="navigation-link active" class="navigation-link">
          <div class="navigation-link">
            <mat-icon>info</mat-icon>
            <span class="list-item">Code of Conduct</span>
          </div>
        </a>
        <a *ngIf="isLoggedIn" mat-list-item (click)="sidenav.toggle()" (click)="onLogout()">
          <div class="navigation-link">
            <mat-icon>exit_to_app</mat-icon>
            <span class="list-item">Logout</span>
          </div>
        </a>
      </div>
    </mat-nav-list>
  </mat-sidenav>

  <mat-sidenav-content>
    <app-loading [content]="user"></app-loading>

    <div *ngIf="user" class="user-wrapper">
      <div class="profile-content">
        <router-outlet></router-outlet>
        <button
          *ngIf="screenWidth < 768"
          mat-fab
          class="fab"
          routerLink="/user/qrcode"
          aria-label="Example icon button with a home icon"
          style="z-index: 99999"
        >
          <mat-icon>qr_code</mat-icon>
        </button>
      </div>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>